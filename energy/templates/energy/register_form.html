{% extends "layout.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'energy/css/style.css' %}">
{% endblock %}

{% block main %}
    <h5>{% block title %}{{ title }}{% endblock %}</h5>
    <hr>

    {% if form.subject.errors %}
        {% for error in form.subject.errors %}
            <div class="alert alert-danger fade show" role="alert">
                {{ error|escape }}
            </div>
        {% endfor %}
    {% endif %}

    <div class="card w-75">
        <div class="card-body">
            <form method="post">{% csrf_token %}
                {{ form.as_p }}

                <p id="id_total">Total para el mes: 0</p>

                <a href="{% url 'energy:index' %}" class="btn btn-success">
                    <i class="bi bi-chevron-left"></i> Cancelar
                </a>

                <button type="submit" class="btn btn-secondary float-end">
                    <i class="bi bi-save"></i> Guardar
                </button>
            </form>

        </div>
    </div>
{% endblock %}

{% block js %}
    <script type="text/javascript">
        let plan_lv = document.getElementById('id_plan_lv');
        let plan_sd = document.getElementById('id_plan_sd');
        let total = document.getElementById('id_total');
        plan_lv.addEventListener('change', () => {
            sum();
        });
        plan_lv.addEventListener('keyup', () => {
            sum();
        });
        plan_sd.addEventListener('change', () => {
            sum();
        });
        plan_sd.addEventListener('keyup', () => {
            sum();
        });

        function sum() {
            let lv_size = plan_lv.value.length;
            let sd_size = plan_sd.value.length;
            if (lv_size > 0 && sd_size > 0) {
                total.innerHTML = 'Total para el mes: ' + (parseInt(plan_lv.value) + parseInt(plan_sd.value));
            }
        }
    </script>
{% endblock %}
